const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["WebGPURenderer-TU3XCd1-.js","bundle2.js","colorToUniform-C2GHuDhf.js","SharedSystems-BvlUeMV9.js","WebGLRenderer-gkTPWw6K.js"])))=>i.map(i=>d[i]);
import{e as A,E as f,a as K,C as G,d as O,v as P,b as E,D as C,_ as N,A as $,l as Q,c as L,S as Z,g as ee,f as H}from"./bundle2.js";const T=[];A.handleByNamedList(f.Environment,T);async function te(r){if(!r)for(let e=0;e<T.length;e++){const n=T[e];if(n.value.test()){await n.value.load();return}}}let p;function re(){if(typeof p=="boolean")return p;try{p=new Function("param1","param2","param3","return param1[param2] === param3;")({a:"b"},"a","b")===!0}catch{p=!1}return p}var j=(r=>(r[r.NONE=0]="NONE",r[r.COLOR=16384]="COLOR",r[r.STENCIL=1024]="STENCIL",r[r.DEPTH=256]="DEPTH",r[r.COLOR_DEPTH=16640]="COLOR_DEPTH",r[r.COLOR_STENCIL=17408]="COLOR_STENCIL",r[r.DEPTH_STENCIL=1280]="DEPTH_STENCIL",r[r.ALL=17664]="ALL",r))(j||{});class ne{constructor(e){this.items=[],this._name=e}emit(e,n,t,s,i,o,c,d){const{name:m,items:l}=this;for(let a=0,u=l.length;a<u;a++)l[a][m](e,n,t,s,i,o,c,d);return this}add(e){return e[this._name]&&(this.remove(e),this.items.push(e)),this}remove(e){const n=this.items.indexOf(e);return n!==-1&&this.items.splice(n,1),this}contains(e){return this.items.indexOf(e)!==-1}removeAll(){return this.items.length=0,this}destroy(){this.removeAll(),this.items=null,this._name=null}get empty(){return this.items.length===0}get name(){return this._name}}const se=["init","destroy","contextChange","resolutionChange","resetState","renderEnd","renderStart","render","update","postrender","prerender"],W=class B extends K{constructor(e){super(),this.runners=Object.create(null),this.renderPipes=Object.create(null),this._initOptions={},this._systemsHash=Object.create(null),this.type=e.type,this.name=e.name,this.config=e;const n=[...se,...this.config.runners??[]];this._addRunners(...n),this._unsafeEvalCheck()}async init(e={}){const n=e.skipExtensionImports===!0?!0:e.manageImports===!1;await te(n),this._addSystems(this.config.systems),this._addPipes(this.config.renderPipes,this.config.renderPipeAdaptors);for(const t in this._systemsHash)e={...this._systemsHash[t].constructor.defaultOptions,...e};e={...B.defaultOptions,...e},this._roundPixels=e.roundPixels?1:0;for(let t=0;t<this.runners.init.items.length;t++)await this.runners.init.items[t].init(e);this._initOptions=e}render(e,n){let t=e;if(t instanceof G&&(t={container:t},n&&(O(P,"passing a second argument is deprecated, please use render options instead"),t.target=n.renderTexture)),t.target||(t.target=this.view.renderTarget),t.target===this.view.renderTarget&&(this._lastObjectRendered=t.container,t.clearColor??(t.clearColor=this.background.colorRgba),t.clear??(t.clear=this.background.clearBeforeRender)),t.clearColor){const s=Array.isArray(t.clearColor)&&t.clearColor.length===4;t.clearColor=s?t.clearColor:E.shared.setValue(t.clearColor).toArray()}t.transform||(t.container.updateLocalTransform(),t.transform=t.container.localTransform),t.container.enableRenderGroup(),this.runners.prerender.emit(t),this.runners.renderStart.emit(t),this.runners.render.emit(t),this.runners.renderEnd.emit(t),this.runners.postrender.emit(t)}resize(e,n,t){const s=this.view.resolution;this.view.resize(e,n,t),this.emit("resize",this.view.screen.width,this.view.screen.height,this.view.resolution),t!==void 0&&t!==s&&this.runners.resolutionChange.emit(t)}clear(e={}){const n=this;e.target||(e.target=n.renderTarget.renderTarget),e.clearColor||(e.clearColor=this.background.colorRgba),e.clear??(e.clear=j.ALL);const{clear:t,clearColor:s,target:i}=e;E.shared.setValue(s??this.background.colorRgba),n.renderTarget.clear(i,t,E.shared.toArray())}get resolution(){return this.view.resolution}set resolution(e){this.view.resolution=e,this.runners.resolutionChange.emit(e)}get width(){return this.view.texture.frame.width}get height(){return this.view.texture.frame.height}get canvas(){return this.view.canvas}get lastObjectRendered(){return this._lastObjectRendered}get renderingToScreen(){return this.renderTarget.renderingToScreen}get screen(){return this.view.screen}_addRunners(...e){e.forEach(n=>{this.runners[n]=new ne(n)})}_addSystems(e){let n;for(n in e){const t=e[n];this._addSystem(t.value,t.name)}}_addSystem(e,n){const t=new e(this);if(this[n])throw new Error(`Whoops! The name "${n}" is already in use`);this[n]=t,this._systemsHash[n]=t;for(const s in this.runners)this.runners[s].add(t);return this}_addPipes(e,n){const t=n.reduce((s,i)=>(s[i.name]=i.value,s),{});e.forEach(s=>{const i=s.value,o=s.name,c=t[o];this.renderPipes[o]=new i(this,c?new c:null)})}destroy(e=!1){this.runners.destroy.items.reverse(),this.runners.destroy.emit(e),Object.values(this.runners).forEach(n=>{n.destroy()}),this._systemsHash=null,this.renderPipes=null}generateTexture(e){return this.textureGenerator.generateTexture(e)}get roundPixels(){return!!this._roundPixels}_unsafeEvalCheck(){if(!re())throw new Error("Current environment does not allow unsafe-eval, please use pixi.js/unsafe-eval module to enable support.")}resetState(){this.runners.resetState.emit()}};W.defaultOptions={resolution:1,failIfMajorPerformanceCaveat:!1,roundPixels:!1};let Y=W,b;function ie(r){return b!==void 0||(b=(()=>{var n;const e={stencil:!0,failIfMajorPerformanceCaveat:r??Y.defaultOptions.failIfMajorPerformanceCaveat};try{if(!C.get().getWebGLRenderingContext())return!1;let s=C.get().createCanvas().getContext("webgl",e);const i=!!((n=s==null?void 0:s.getContextAttributes())!=null&&n.stencil);if(s){const o=s.getExtension("WEBGL_lose_context");o&&o.loseContext()}return s=null,i}catch{return!1}})()),b}let x;async function ae(r={}){return x!==void 0||(x=await(async()=>{const e=C.get().getNavigator().gpu;if(!e)return!1;try{return await(await e.requestAdapter(r)).requestDevice(),!0}catch{return!1}})()),x}const D=["webgl","webgpu","canvas"];async function oe(r){let e=[];r.preference?(e.push(r.preference),D.forEach(i=>{i!==r.preference&&e.push(i)})):e=D.slice();let n,t={};for(let i=0;i<e.length;i++){const o=e[i];if(o==="webgpu"&&await ae()){const{WebGPURenderer:c}=await N(async()=>{const{WebGPURenderer:d}=await import("./WebGPURenderer-TU3XCd1-.js");return{WebGPURenderer:d}},__vite__mapDeps([0,1,2,3]));n=c,t={...r,...r.webgpu};break}else if(o==="webgl"&&ie(r.failIfMajorPerformanceCaveat??Y.defaultOptions.failIfMajorPerformanceCaveat)){const{WebGLRenderer:c}=await N(async()=>{const{WebGLRenderer:d}=await import("./WebGLRenderer-gkTPWw6K.js");return{WebGLRenderer:d}},__vite__mapDeps([4,1,2,3]));n=c,t={...r,...r.webgl};break}else if(o==="canvas")throw t={...r},new Error("CanvasRenderer is not yet implemented")}if(delete t.webgpu,delete t.webgl,!n)throw new Error("No available renderer for the current environment");const s=new n;return await s.init(t),s}const M="8.9.2";class z{static init(){var e;(e=globalThis.__PIXI_APP_INIT__)==null||e.call(globalThis,this,M)}static destroy(){}}z.extension=f.Application;class le{constructor(e){this._renderer=e}init(){var e;(e=globalThis.__PIXI_RENDERER_INIT__)==null||e.call(globalThis,this._renderer,M)}destroy(){this._renderer=null}}le.extension={type:[f.WebGLSystem,f.WebGPUSystem],name:"initHook",priority:-10};const F=class R{constructor(...e){this.stage=new G,e[0]!==void 0&&O(P,"Application constructor options are deprecated, please use Application.init() instead.")}async init(e){e={...e},this.renderer=await oe(e),R._plugins.forEach(n=>{n.init.call(this,e)})}render(){this.renderer.render({container:this.stage})}get canvas(){return this.renderer.canvas}get view(){return O(P,"Application.view is deprecated, please use Application.canvas instead."),this.renderer.canvas}get screen(){return this.renderer.screen}destroy(e=!1,n=!1){const t=R._plugins.slice(0);t.reverse(),t.forEach(s=>{s.destroy.call(this)}),this.stage.destroy(n),this.stage=null,this.renderer.destroy(e),this.renderer=null}};F._plugins=[];let U=F;A.handleByList(f.Application,U._plugins);A.add(z);(async()=>{const r=new U;let e=document.getElementById("stage");await r.init({background:"#1099bb",resizeTo:e,autoDensity:!0,antialiasing:!1,hello:!0}),console.log("Device Pixel Ratio:",window.devicePixelRatio),console.log("PixiJS Renderer Resolution:",r.renderer.resolution);const n=1,t=.05,s=.2;e.appendChild(r.canvas);const i=await $.load("https://pixijs.com/assets/bunny.png"),o=await Q(),c=await L("/assets/rachel_idle.json"),d=await L("/assets/rachel_walk.json"),m={idle:c,walking:d},l=new Z(i),a=ee(m.idle,r),u=H(o.textures["grassy (Grass).aseprite"],r),w=H(o.textures["grassy (Sky).aseprite"],r);l.anchor.set(.5),l.x=r.screen.width/2,l.y=r.screen.height/2,a.anchor.set(0,1),a.y=r.screen.height*.9,a.x=r.screen.width*.1,a.animationSpeed=s,a.play(),console.log("Screen size"),console.log(r.screen.width),console.log(r.screen.height);function V(){u.width=r.screen.width,u.height=r.screen.height,w.width=r.screen.width,w.height=r.screen.height,l.x=r.screen.width/2,l.y=r.screen.height/2,k()}r.renderer.on("resize",V);const q=document.documentElement.scrollHeight-document.documentElement.clientHeight,h=document.getElementById("preamble").clientHeight,X=q-h;let g=window.scrollY,_=g-h>0?g-h:0,S=0,v=0,I=null,y=!1;console.log("Preamble height"),console.log(h);function k(){v=window.scrollY-g,y&&(a.animationSpeed=Math.abs(v)/50),g=window.scrollY,_=g-h>0?g-h:0,S=_>0?_/X:0,console.log(_),console.log(S),l.x=r.renderer.width*S,u.tilePosition.x-=v*n,w.tilePosition.x-=v*t}window.addEventListener("scroll",()=>{clearTimeout(I),y||(console.log("Scroll detected: Rachel starts walking."),a.textures=m.walking,a.play(),y=!0),I=setTimeout(()=>{console.log("Scroll stopped: Rachel goes idle."),a.textures=m.idle,a.animationSpeed=s,a.play(),y=!1},300),requestAnimationFrame(k)}),r.stage.addChild(w),r.stage.addChild(u),r.stage.addChild(l),r.stage.addChild(a),l.x,r.ticker.add(J=>{l.rotation+=.1*J.deltaTime})})();export{Y as A,j as C,le as R,ne as S,M as V,re as u};
